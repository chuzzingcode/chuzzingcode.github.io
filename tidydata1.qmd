---
title: "Changes in Household Plumbing Access, 2022–2023"
author: "Chris Hussey"
format:
  html:
    code-fold: true
execute:
  echo: true
  warning: false
  message: false
---

This analysis uses county-level data from the **U.S. Census Bureau’s American Community Survey (ACS) 1-year estimates** for 2022 and 2023. I focus on two variables 1) **Total population** in each county (Table B01003) and 2) **Number of households lacking complete plumbing** (Table B25049)

Using these, I calculate the **percentage of households without complete indoor plumbing** and then compare 2022 to 2023 across all U.S. counties included in the ACS 1-year sample. The goal is to understand whether counties with higher plumbing insecurity in 2022 tended to see improvement, worsening, or stability in 2023.

This data set came from the U.S. Census Bureau’s American Community Survey (ACS) for 2022 and 2023. It tracks county-level population and the share of households without complete plumbing, letting us see how access to basic facilities has changed over time.

```{r}

# Clean data compiled from code referenced in article (https://waterdata.usgs.gov/blog/acs-maps/). 
# Code was revised to pull data for all US counties for years 2022 - 2023.

# Load packages -----
library(tidycensus)
library(sf) 
library(janitor) 
library(tidyverse)



# Helper functions -----
get_census_data <- function(geography, var_names, year, proj, survey_var) {
  df <- get_acs(
    geography = geography,
    variable = var_names,
    year = year,
    geometry = FALSE,
    survey = survey_var) |>
    clean_names() |>
    mutate(year = year)
  
  return(df) 
}

# Grab relevant variables - B01003_001: total population, B25049_004: households lacking plumbing----
vars <- c("B01003_001", "B25049_004")

# Pull data for 2023 and 2022 for all US counties ------
water_insecurity_2023 <- get_census_data(
  geography = 'county', 
  var_names = vars, 
  year = "2023", 
  proj = "EPSG:5070", 
  survey_var = "acs1"
) |>
  mutate(
    variable_long = case_when(
      variable == "B01003_001" ~ "total_pop",
      variable == "B25049_004" ~ "plumbing",
      .default = NA_character_  
    )
  ) |> 
  select(geoid, name, variable_long, estimate, year) |> 
  pivot_wider(
    names_from = variable_long,
    values_from = estimate
  ) |> 
  mutate(
    percent_lacking_plumbing = (plumbing / total_pop) * 100
  )

water_insecurity_2022 <- get_census_data(
  geography = 'county', 
  var_names = vars, 
  year = "2022", 
  proj = "EPSG:5070", 
  survey_var = "acs1"
) |>
  mutate(
    variable_long = case_when(
      variable == "B01003_001" ~ "total_pop",
      variable == "B25049_004" ~ "plumbing",
      .default = NA_character_  
    )
  ) |> 
  select(geoid, name, variable_long, estimate, year) |> 
  pivot_wider(
    names_from = variable_long,
    values_from = estimate
  ) |> 
  mutate(
    percent_lacking_plumbing = (plumbing / total_pop) * 100
  )
```

```{r}


# Combine 2022 and 2023 data into one comparison data frame
wi23 <- water_insecurity_2023 |> 
  as.data.frame() |> 
  select(geoid, name, percent_lacking_plumbing) |> 
  rename(p23 = percent_lacking_plumbing)

wi22 <- water_insecurity_2022 |> 
  as.data.frame() |> 
  select(geoid, name, percent_lacking_plumbing) |> 
  rename(p22 = percent_lacking_plumbing)


# Inner join keeps only counties that appear in both years
comp <- inner_join(wi23, wi22, by = c("geoid", "name"))


```

This a quick exploratory summary of each year.

```{r}

# This gives you a sense of the distribution in each year.
comp |>
  select(p22, p23) |>
  summary()
```

```{r}
#| fig-alt: "A County-level scatterplot comparison of the percentage of households lacking complete indoor plumbing, 2022 vs. 2023."

ggplot(comp, aes(x = p22, y = p23)) +
  geom_point(alpha = 0.6, size = 1.2) +              # scatter points
  geom_smooth(method = "lm", se = FALSE) +           # simple trend line
  scale_x_continuous(labels = scales::label_percent(accuracy = 0.01)) +
  scale_y_continuous(labels = scales::label_percent(accuracy = 0.01)) +
  labs(
    title = "U.S. Counties: Percent Lacking Complete Indoor Plumbing",
    subtitle = "Comparing 2023 vs. 2022 ACS 1-year Estimates",
    x = "2022 % lacking plumbing",
    y = "2023 % lacking plumbing",
    caption = "Source: U.S. Census Bureau, ACS 1-year Estimates (tidycensus)"
  ) +
  theme_minimal(base_size = 12)
```

In this visualization, each point represents an overlapping county included in both 2022 and 2023 versions of American Community Survey with a ≥65k population. If plumbing access remained the same all points would fall along the diagonal trend line. The scatter shows that while many counties cluster close to that line, some saw higher shares of households lacking complete plumbing in 2023 (points above the line), and others saw improvements (points below).

References:

**TidyTuesday Source:** R4DS Online Learning Community. (2025). *TidyTuesday: ACS Plumbing and Population Data (2025-01-28).* TidyTuesday project. Retrieved from <https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-01-28/readme.md>

**Original Data Source:** U.S. Census Bureau. (2022–2023). *American Community Survey (ACS) 1-year Estimates, Tables B01003 (Total Population) and B25049 (Plumbing Facilities).* Washington, DC: U.S. Department of Commerce. Retrieved from <https://www.census.gov/programs-surveys/acs/data.html>
